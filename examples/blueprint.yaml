tosca_definitions_version: cloudify_dsl_1_4

imports:
  - cloudify/types/types.yaml
  # you import you plugin after building the wagon 
  # and uploading it to the manager
  - plugin:cloudify-equinix-metal-plugin

inputs:

  project_id:
    type: string
  api_key:
    type: string
  hostname:
    type: string
  metro:
    type: string
    constraints:
      - valid_values: ['SV', 'AM', 'NY', 'DC', 'FR']
    default: SV
  plan:
    type: string
    constraints:
      - valid_values: ['c3.small.x86', 'c3.medium.x86']
    default: c3.small.x86
  operating_system:
    type: string
    constraints:
      - valid_values: ['ubuntu_22_04']
    default: ubuntu_22_04
  userdata:
    type: string
    default: ''

dsl_definitions:

  equinix_config: &equinix_config
    project_id: { get_input: project_id }
    api_key: { get_input: api_key }
    hostname: { get_input: hostname }
    metro: { get_input: metro }
    plan: { get_input: plan }
    operating_system: { get_input: operating_system }

node_templates:

  # actual node to be created with the type defined in the plugin
  equinix_metal:
    type: cloudify.nodes.template.EquinixMetal
    properties:
      equinix_config: *equinix_config

  